{{define "header"}}
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="/_/css/bootstrap.min.css" rel="stylesheet">
    <link href="/_/css/lightbox.min.css" rel="stylesheet">
    <link href="/_/css/image-server.css" rel="stylesheet">
    <link rel="icon" href="/_/images/logo.jpg" type="image/jpeg">
    <title>ImageServer</title>
</head>
<body>
{{end}}

{{define "breadcrumb"}}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/" class="text-decoration-none">ImageServer</a></li>
        {{range breadCrumb .Path }}
        <li class="breadcrumb-item"><a href="{{ . }}">{{ pathToName . }}</a></li>
        {{end}}
        <li class="ml-auto">
            {{ if .PreFolder }}
            <a href="{{.PreFolder}}" class="badge badge-success mx-3"> < </a>
            {{else}}
            <span class="badge badge-secondary mx-3 invisible"> < </span>
            {{end}}
            {{if .NextFolder}}
            <a href="{{.NextFolder}}" class="badge badge-success mx-3"> > </a>
            {{else}}
            <span class="badge badge-secondary mx-3 invisible"> > </span>
            {{end}}
            <span class="badge btn-primary" data-toggle="modal" data-target="#settingsModal">
                #
            </span>
        </li>
    </ol>
</nav>
<div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Settings</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="lineImages">Images Per Line</label>
                        <select class="form-control" id="lineImages">
                            <option value="">Not Limited</option>
                            <option value="col-md-12">1</option>
                            <option value="col-md-6">2</option>
                            <option value="col-md-4">3</option>
                            <option value="col-md-3">4</option>
                            <option value="col-md-2">6</option>
                            <option value="col-md-1">12</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="lineVideos">Videos Per Line</label>
                        <select class="form-control" id="lineVideos">
                            <option value="">Not Limited</option>
                            <option value="col-md-12">1</option>
                            <option value="col-md-6">2</option>
                            <option value="col-md-4">3</option>
                            <option value="col-md-3">4</option>
                            <option value="col-md-2">6</option>
                            <option value="col-md-1">12</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="videoPreload">Video Preload</label>
                        <select class="form-control" id="videoPreload">
                            <option value="none">Nope</option>
                            <option value="metadata">Cover</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <span>Made with ❤️ <a href="https://haoyu.love" class="text-decoration-none" target="_blank">Yu Hao</a></span>
            </div>
        </div>
    </div>
</div>
{{end}}


{{define "footer"}}
<script src="/_/js/jquery.min.js"></script>
<script src="/_/js/bootstrap.bundle.min.js"></script>
<script src="/_/js/lightbox.min.js"></script>
<script src="/_/js/js.cookie.min.js"></script>
<script>
    $(document).ready(function () {

        function defaultCookie() {
            if (undefined == Cookies.get('image_class')) {
                Cookies.set('image_class', 'col-md-4');
            }
            $("#lineImages").val(Cookies.get('image_class'));

            if (undefined == Cookies.get('video_class')) {
                Cookies.set('video_class', 'col-md-4');
            }
            $("#lineVideos").val(Cookies.get('video_class'));

            if (undefined == Cookies.get('video_preload')) {
                Cookies.set('video_preload', 'none');
            }
            $("#videoPreload").val(Cookies.get('video_preload'));
        }

        function applyStyle() {
            $("a.img-thumbnail").addClass(Cookies.get('image_class'));
            $("figure.img-thumbnail").addClass(Cookies.get('video_class'));
            $("video").prop("preload", Cookies.get('video_preload'));
        }

        function darkMode() {
            var hour = (new Date()).getHours();
            if (hour <= 7 || hour >= 19) {
                $(['body', 'figure', '.img-thumbnail', '.modal-content', '.jumbotron']).each((i, ele) => {
                    $(ele).addClass('bg-dark');
                })
                $('nav>ol').addClass('bg-secondary');

                $('table').addClass('table-dark');

                $('body').addClass('text-white-50');
                $('a').addClass('text-white');
            }
        }

        lightbox.option({
            'disableScrolling': true,
            'resizeDuration': 0,
            'wrapAround': true,
            'fadeDuration': 0,
            'imageFadeDuration': 0
        });

        darkMode();
        defaultCookie();
        applyStyle();
        $("#lineImages").change(function () {
            Cookies.set('image_class', $("#lineImages").val());
        })
        $("#lineVideos").change(function () {
            Cookies.set('video_class', $("#lineVideos").val());
        })
        $("#videoPreload").change(function () {
            Cookies.set('video_preload', $("#videoPreload").val());
        })
    })
</script>
</body>
</html>
{{end}}